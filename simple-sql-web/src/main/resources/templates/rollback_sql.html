<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
	<head th:replace="~{fragments/site_head :: siteHead}"></head>
	<body>
		<div th:replace="~{fragments/layout_header :: layoutHeader}"></div>
		<div class="container">
			<div class="card">
				<h1>ğŸ§¯ ç”Ÿæˆ SQL å›é€€è„šæœ¬</h1>

				<div class="section">
					<div class="section-title">
						<strong>åŠŸèƒ½è¯´æ˜</strong>
					</div>
					<div class="feature-note">
						<div class="feature-row">
							<span class="feature-index">1</span>
							<span class="feature-text">ä¸Šä¼ åŒ…å« INSERT è¯­å¥çš„ SQL æ–‡ä»¶</span>
						</div>
						<div class="feature-row">
							<span class="feature-index">2</span>
							<span class="feature-text">
								ç³»ç»Ÿä¼šè‡ªåŠ¨è§£æ INSERT è¯­å¥å¹¶ç”Ÿæˆå¯¹åº”çš„ DELETE å›é€€è„šæœ¬
							</span>
						</div>
						<div class="feature-row">
							<span class="feature-index">3</span>
							<span class="feature-text"
								>å…¶ä»–è¯­å¥ç±»å‹ï¼ˆUPDATEã€DELETE ç­‰ï¼‰ä¼šè¢«å¿½ç•¥</span
							>
						</div>
						<div class="feature-row">
							<span class="feature-index">4</span>
							<span class="feature-text"
								>ç”Ÿæˆçš„å›é€€è„šæœ¬å¯ç”¨äºå›æ»šæ•°æ®åº“æ“ä½œ</span
							>
						</div>
						<div class="feature-row">
							<span class="feature-index">5</span>
							<span class="feature-text">ç‚¹å‡» "ç”Ÿæˆå›é€€è„šæœ¬" å¼€å§‹ç”Ÿæˆ</span>
						</div>
					</div>
				</div>

				<div class="section section-collapsible">
					<button
						type="button"
						class="section-toggle"
						id="usageExampleToggle"
						aria-expanded="false"
						aria-controls="usageExampleBody"
						onclick="toggleUsageExample()"
					>
						<span class="section-toggle-label">
							<strong>ä½¿ç”¨æ¡ˆä¾‹</strong>
							<span class="section-toggle-badge">å¯å±•å¼€æŸ¥çœ‹ç¤ºä¾‹</span>
						</span>
						<span class="section-toggle-icon" aria-hidden="true">âŒ„</span>
					</button>
					<div id="usageExampleBody" class="section-body is-collapsed">
						<p class="note">å‡è®¾æ‚¨çš„ SQL æ–‡ä»¶ä¸­åŒ…å«ä»¥ä¸‹ INSERT è¯­å¥ï¼š</p>

						<div style="margin-top: 8px">
							<div class="note"><strong>åŸå§‹ INSERT è¯­å¥</strong>ï¼š</div>
							<pre
								class="code-block"
								style="
									white-space: pre-wrap;
									word-wrap: break-word;
									overflow-wrap: break-word;
								"
							>
INSERT INTO `user_info` (`id`, `name`, `age`, `status`) VALUES 
('1', 'Alice', '20', 'ACTIVE'), 
('2', 'Bob', '30', 'INACTIVE');</pre
							>
						</div>

						<div style="margin-top: 8px">
							<div class="note"><strong>ç”Ÿæˆçš„ DELETE å›é€€è„šæœ¬</strong>ï¼š</div>
							<pre
								class="code-block"
								style="
									white-space: pre-wrap;
									word-wrap: break-word;
									overflow-wrap: break-word;
								"
							>
DELETE FROM `user_info` WHERE `id` = '1' AND `name` = 'Alice' AND `age` = '20' AND `status` = 'ACTIVE';
DELETE FROM `user_info` WHERE `id` = '2' AND `name` = 'Bob' AND `age` = '30' AND `status` = 'INACTIVE';</pre
							>
						</div>

						<div style="margin-top: 12px">
							<p class="note">
								ğŸ’¡ <strong>æç¤º</strong>ï¼šç”Ÿæˆçš„ DELETE è¯­å¥ä½¿ç”¨æ‰€æœ‰åˆ—ä½œä¸º WHERE
								æ¡ä»¶ï¼Œç¡®ä¿ç²¾ç¡®åŒ¹é…è¦å›æ»šçš„æ•°æ®è¡Œã€‚
							</p>
						</div>
					</div>
				</div>

				<div th:if="${error}" class="error" th:text="${error}">å‘ç”Ÿé”™è¯¯</div>
				<div th:if="${success}" class="success" th:text="${success}">
					æ“ä½œæˆåŠŸ
				</div>

				<form
					class="form"
					th:action="@{/rollback/generate}"
					method="post"
					enctype="multipart/form-data"
				>
					<div
						th:replace="~{fragments/file_upload :: uploadField('file','file','.sql','ä¸Šä¼  SQL æ–‡ä»¶','é€‰æ‹© SQL æ–‡ä»¶')}"
					></div>
					<div class="actions">
						<button type="submit">ç”Ÿæˆå›é€€è„šæœ¬</button>
					</div>
				</form>

				<div th:if="${outputPath}" class="result">
					<div>
						<strong>è¾“å‡ºè·¯å¾„ï¼š</strong
						><span th:text="${outputPath}">/path/to/rollback.sql</span>
					</div>
					<div style="margin-top: 8px">
						<a class="btn" th:if="${downloadUrl}" th:href="${downloadUrl}"
							>ä¸‹è½½å›é€€è„šæœ¬</a
						>
					</div>
				</div>

				<div th:if="${outputPath}" class="result">
					<div th:if="${previewContent}" style="margin-top: 12px">
						<div><strong>é¢„è§ˆï¼š</strong></div>
						<pre
							class="code-block"
							style="max-height: 360px; overflow: auto; white-space: pre-wrap"
							th:text="${previewContent}"
						></pre>
					</div>
					<div th:if="${previewTooLarge}" class="note" style="margin-top: 8px">
						ç”Ÿæˆå†…å®¹è¾ƒå¤§ï¼Œä¸ºé¿å…é¡µé¢å¡é¡¿ï¼Œè¯·ç‚¹å‡»ä¸Šæ–¹â€œä¸‹è½½å›é€€è„šæœ¬â€åä½¿ç”¨æœ¬åœ°ç¼–è¾‘å™¨æŸ¥çœ‹ã€‚
					</div>
				</div>
			</div>
		</div>
		<div th:replace="~{fragments/layout_footer :: layoutFooter}"></div>

		<script>
			function toggleUsageExample() {
				var body = document.getElementById("usageExampleBody");
				var toggle = document.getElementById("usageExampleToggle");
				if (!body || !toggle) return;
				var expanded = toggle.getAttribute("aria-expanded") === "true";
				if (expanded) {
					toggle.setAttribute("aria-expanded", "false");
					toggle.classList.remove("is-open");
					body.classList.add("is-collapsed");
				} else {
					toggle.setAttribute("aria-expanded", "true");
					toggle.classList.add("is-open");
					body.classList.remove("is-collapsed");
				}
			}
		</script>
	</body>
</html>
